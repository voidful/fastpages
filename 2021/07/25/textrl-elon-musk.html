<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Title | Voidful</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Title" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Voidful.Dev" />
<meta property="og:description" content="Voidful.Dev" />
<link rel="canonical" href="https://voidful.dev/2021/07/25/textrl-elon-musk.html" />
<meta property="og:url" content="https://voidful.dev/2021/07/25/textrl-elon-musk.html" />
<meta property="og:site_name" content="Voidful" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-07-25T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"Voidful.Dev","url":"https://voidful.dev/2021/07/25/textrl-elon-musk.html","@type":"BlogPosting","headline":"Title","dateModified":"2021-07-25T00:00:00-05:00","datePublished":"2021-07-25T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://voidful.dev/2021/07/25/textrl-elon-musk.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://voidful.dev/feed.xml" title="Voidful" /><!-- the google_analytics_id gets auto inserted from the config file -->



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZBQF1JGJPM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ZBQF1JGJPM');
</script>


<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Voidful</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Title</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-07-25T00:00:00-05:00" itemprop="datePublished">
        Jul 25, 2021
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      10 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/voidful//tree/master/_notebooks/2021-07-25-textrl-elon-musk.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/voidful//master?filepath=_notebooks%2F2021-07-25-textrl-elon-musk.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/voidful//blob/master/_notebooks/2021-07-25-textrl-elon-musk.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-07-25-textrl-elon-musk.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="o">&gt;</span> <span class="n">A</span> <span class="n">example</span> <span class="n">showing</span> <span class="n">how</span> <span class="n">to</span> <span class="n">control</span> <span class="n">text</span> <span class="n">generation</span> <span class="n">through</span> <span class="n">a</span> <span class="n">sentiment</span> <span class="n">classifier</span><span class="o">.</span>

<span class="o">-</span> <span class="n">toc</span><span class="p">:</span> <span class="n">true</span> 
<span class="o">-</span> <span class="n">badges</span><span class="p">:</span> <span class="n">true</span>
<span class="o">-</span> <span class="n">comments</span><span class="p">:</span> <span class="n">true</span>
<span class="o">-</span> <span class="n">categories</span><span class="p">:</span> <span class="p">[</span><span class="n">jupyter</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">from</span> <span class="nn">textrl</span> <span class="kn">import</span> <span class="n">TextRLEnv</span><span class="p">,</span><span class="n">TextRLActor</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">pipeline</span><span class="p">,</span> <span class="n">AutoModelForTokenClassification</span><span class="p">,</span> <span class="n">AutoTokenizer</span><span class="p">,</span> <span class="n">AutoModelWithLMHead</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">pfrl</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Using a pre-trained model, it can generate elonmusk's style tweets.</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;huggingtweets/elonmusk&quot;</span><span class="p">)</span>  
<span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelWithLMHead</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;huggingtweets/elonmusk&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/transformers/models/auto/modeling_auto.py:902: FutureWarning: The class `AutoModelWithLMHead` is deprecated and will be removed in a future version. Please use `AutoModelForCausalLM` for causal language models, `AutoModelForMaskedLM` for masked language models and `AutoModelForSeq2SeqLM` for encoder-decoder models.
  FutureWarning,
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>GPT2LMHeadModel(
  (transformer): GPT2Model(
    (wte): Embedding(50257, 768)
    (wpe): Embedding(1024, 768)
    (drop): Dropout(p=0.1, inplace=False)
    (h): ModuleList(
      (0): GPT2Block(
        (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (resid_dropout): Dropout(p=0.1, inplace=False)
        )
        (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (1): GPT2Block(
        (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (resid_dropout): Dropout(p=0.1, inplace=False)
        )
        (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (2): GPT2Block(
        (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (resid_dropout): Dropout(p=0.1, inplace=False)
        )
        (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (3): GPT2Block(
        (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (resid_dropout): Dropout(p=0.1, inplace=False)
        )
        (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (4): GPT2Block(
        (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (resid_dropout): Dropout(p=0.1, inplace=False)
        )
        (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (5): GPT2Block(
        (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (resid_dropout): Dropout(p=0.1, inplace=False)
        )
        (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (6): GPT2Block(
        (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (resid_dropout): Dropout(p=0.1, inplace=False)
        )
        (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (7): GPT2Block(
        (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (resid_dropout): Dropout(p=0.1, inplace=False)
        )
        (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (8): GPT2Block(
        (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (resid_dropout): Dropout(p=0.1, inplace=False)
        )
        (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (9): GPT2Block(
        (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (resid_dropout): Dropout(p=0.1, inplace=False)
        )
        (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (10): GPT2Block(
        (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (resid_dropout): Dropout(p=0.1, inplace=False)
        )
        (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (11): GPT2Block(
        (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (attn): GPT2Attention(
          (c_attn): Conv1D()
          (c_proj): Conv1D()
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (resid_dropout): Dropout(p=0.1, inplace=False)
        )
        (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (mlp): GPT2MLP(
          (c_fc): Conv1D()
          (c_proj): Conv1D()
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
  )
  (lm_head): Linear(in_features=768, out_features=50257, bias=False)
)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>a sentiment classifier for rl reward</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">sentiment</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">(</span><span class="s1">&#39;sentiment-analysis&#39;</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;cardiffnlp/twitter-roberta-base-sentiment&quot;</span><span class="p">,</span><span class="n">tokenizer</span><span class="o">=</span><span class="s2">&quot;cardiffnlp/twitter-roberta-base-sentiment&quot;</span><span class="p">,</span><span class="n">device</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">return_all_scores</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">transformers_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;transformers&#39;</span><span class="p">)</span>
<span class="n">transformers_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">sentiment</span><span class="p">(</span><span class="s2">&quot;dogecoin is bad&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[[{&#39;label&#39;: &#39;LABEL_0&#39;, &#39;score&#39;: 0.9338533878326416},
  {&#39;label&#39;: &#39;LABEL_1&#39;, &#39;score&#39;: 0.060118917375802994},
  {&#39;label&#39;: &#39;LABEL_2&#39;, &#39;score&#39;: 0.0060277231968939304}]]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">sentiment</span><span class="p">(</span><span class="s2">&quot;dogecoin is bad&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9338533878326416</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>set our text generation reward, inverse perplexity + sentiment classifier.</p>
<ul>
<li>inverse perplexity make sure the generated sentence probability will be high.</li>
<li>sentiment classifier can make the generate more negative.</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">class</span> <span class="nc">MyRLEnv</span><span class="p">(</span><span class="n">TextRLEnv</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get_reward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_text</span><span class="p">,</span> <span class="n">predicted_list</span><span class="p">,</span> <span class="n">finish</span><span class="p">):</span> <span class="c1"># predicted will be the list of predicted token</span>
      <span class="n">reward</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">if</span> <span class="n">finish</span><span class="p">:</span>
        <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">predicted_list</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span>
          <span class="n">predicted_text</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">convert_tokens_to_string</span><span class="p">(</span><span class="n">predicted_list</span><span class="p">)</span>
          <span class="c1"># inverse perplexity</span>
          <span class="n">inputs</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="p">(</span><span class="n">input_text</span><span class="o">+</span><span class="n">predicted_text</span><span class="p">,</span><span class="n">return_tensors</span><span class="o">=</span><span class="s1">&#39;pt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
          <span class="n">reward</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">loss</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()))</span>
          <span class="c1"># sentiment classifier</span>
          <span class="n">reward</span> <span class="o">+=</span> <span class="n">sentiment</span><span class="p">(</span><span class="n">predicted_text</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">]</span>
      <span class="k">return</span> <span class="n">reward</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>fit one example</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">observaton_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;i think dogecoin is&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">env</span> <span class="o">=</span> <span class="n">MyRLEnv</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">,</span> <span class="n">observation_input</span><span class="o">=</span><span class="n">observaton_list</span><span class="p">)</span>
<span class="n">actor</span> <span class="o">=</span> <span class="n">TextRLActor</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">tokenizer</span><span class="p">)</span>
<span class="n">agent</span> <span class="o">=</span> <span class="n">actor</span><span class="o">.</span><span class="n">agent_ppo</span><span class="p">(</span><span class="n">update_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">minibatch_size</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">actor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="s1">&#39;i think dogecoin is&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39; a great idea.&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">pfrl</span><span class="o">.</span><span class="n">experiments</span><span class="o">.</span><span class="n">train_agent_with_evaluation</span><span class="p">(</span>
    <span class="n">agent</span><span class="p">,</span>
    <span class="n">env</span><span class="p">,</span>
    <span class="n">steps</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">eval_n_steps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">eval_n_episodes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>       
    <span class="n">train_max_episode_len</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>  
    <span class="n">eval_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">outdir</span><span class="o">=</span><span class="s1">&#39;elon_musk_dogecoin&#39;</span><span class="p">,</span> 
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>outdir:elon_musk_dogecoin step:28 episode:0 R:0.11256813772978423
statistics:[(&#39;average_value&#39;, -1.1820644), (&#39;average_entropy&#39;, 71312.86), (&#39;average_value_loss&#39;, 1.5397733084180139), (&#39;average_policy_loss&#39;, -0.0005778993137496537), (&#39;n_updates&#39;, 33), (&#39;explained_variance&#39;, -36.946850889108426)]
evaluation episode 0 length:15 R:0.6118701571341162
The best score is updated -3.4028235e+38 -&gt; 0.6118701571341162
Saved the agent to elon_musk_dogecoin/best
outdir:elon_musk_dogecoin step:33 episode:1 R:0.04733136688125236
statistics:[(&#39;average_value&#39;, -1.1896302), (&#39;average_entropy&#39;, 71312.86), (&#39;average_value_loss&#39;, 1.5780798437840797), (&#39;average_policy_loss&#39;, -0.0006748329104833401), (&#39;n_updates&#39;, 34), (&#39;explained_variance&#39;, -0.7300913744865904)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:38 episode:2 R:0.051060883339943464
statistics:[(&#39;average_value&#39;, -1.1958332), (&#39;average_entropy&#39;, 71312.86), (&#39;average_value_loss&#39;, 1.5780798437840797), (&#39;average_policy_loss&#39;, -0.0006748329104833401), (&#39;n_updates&#39;, 34), (&#39;explained_variance&#39;, -0.7300913744865904)]
outdir:elon_musk_dogecoin step:87 episode:3 R:0.1912596257209756
statistics:[(&#39;average_value&#39;, -1.2554632), (&#39;average_entropy&#39;, 71312.94), (&#39;average_value_loss&#39;, 1.5440955738990734), (&#39;average_policy_loss&#39;, -0.0002805701943333798), (&#39;n_updates&#39;, 39), (&#39;explained_variance&#39;, -390.4063933607259)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:103 episode:4 R:0.5811674822406133
statistics:[(&#39;average_value&#39;, -1.2457539), (&#39;average_entropy&#39;, 71312.98), (&#39;average_value_loss&#39;, 1.5156753742840232), (&#39;average_policy_loss&#39;, -0.0002032094211821592), (&#39;n_updates&#39;, 41), (&#39;explained_variance&#39;, -51.0615278646253)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:112 episode:5 R:0.06606750377697743
statistics:[(&#39;average_value&#39;, -1.2375408), (&#39;average_entropy&#39;, 71312.99), (&#39;average_value_loss&#39;, 1.5108967859830176), (&#39;average_policy_loss&#39;, -8.875665203266267e-05), (&#39;n_updates&#39;, 42), (&#39;explained_variance&#39;, -1.4907311649594996)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:117 episode:6 R:0.04733136688125236
statistics:[(&#39;average_value&#39;, -1.2344139), (&#39;average_entropy&#39;, 71313.01), (&#39;average_value_loss&#39;, 1.5108967859830176), (&#39;average_policy_loss&#39;, -8.875665203266267e-05), (&#39;n_updates&#39;, 42), (&#39;explained_variance&#39;, -1.4907311649594996)]
outdir:elon_musk_dogecoin step:133 episode:7 R:0.055373401821994093
statistics:[(&#39;average_value&#39;, -1.227982), (&#39;average_entropy&#39;, 71313.06), (&#39;average_value_loss&#39;, 1.493516572158445), (&#39;average_policy_loss&#39;, -8.711994806534759e-05), (&#39;n_updates&#39;, 44), (&#39;explained_variance&#39;, -78.9884378834259)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:148 episode:8 R:0.13826534376486688
statistics:[(&#39;average_value&#39;, -1.2197058), (&#39;average_entropy&#39;, 71313.1), (&#39;average_value_loss&#39;, 1.4825191640191608), (&#39;average_policy_loss&#39;, 0.00019809898391637642), (&#39;n_updates&#39;, 45), (&#39;explained_variance&#39;, -33.81824737099633)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:198 episode:9 R:0
statistics:[(&#39;average_value&#39;, -1.1569879), (&#39;average_entropy&#39;, 71313.22), (&#39;average_value_loss&#39;, 1.3934581258893013), (&#39;average_policy_loss&#39;, 0.00033982125845795965), (&#39;n_updates&#39;, 50), (&#39;explained_variance&#39;, -431.32679512670745)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:213 episode:10 R:0.06352318183982744
statistics:[(&#39;average_value&#39;, -1.136288), (&#39;average_entropy&#39;, 71313.25), (&#39;average_value_loss&#39;, 1.3678271796267767), (&#39;average_policy_loss&#39;, 0.00024142916698530407), (&#39;n_updates&#39;, 52), (&#39;explained_variance&#39;, -32.041422884933674)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:216 episode:11 R:0.026587595267637088
statistics:[(&#39;average_value&#39;, -1.1333122), (&#39;average_entropy&#39;, 71313.25), (&#39;average_value_loss&#39;, 1.3678271796267767), (&#39;average_policy_loss&#39;, 0.00024142916698530407), (&#39;n_updates&#39;, 52), (&#39;explained_variance&#39;, -32.041422884933674)]
outdir:elon_musk_dogecoin step:221 episode:12 R:0.04169077246803829
statistics:[(&#39;average_value&#39;, -1.1245402), (&#39;average_entropy&#39;, 71313.266), (&#39;average_value_loss&#39;, 1.3501226932934995), (&#39;average_policy_loss&#39;, 0.0001948871455547391), (&#39;n_updates&#39;, 53), (&#39;explained_variance&#39;, -370.5535500115619)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:229 episode:13 R:0.04640172880556339
statistics:[(&#39;average_value&#39;, -1.1159837), (&#39;average_entropy&#39;, 71313.27), (&#39;average_value_loss&#39;, 1.3501226932934995), (&#39;average_policy_loss&#39;, 0.0001948871455547391), (&#39;n_updates&#39;, 53), (&#39;explained_variance&#39;, -370.5535500115619)]
outdir:elon_musk_dogecoin step:234 episode:14 R:0.051060883339943464
statistics:[(&#39;average_value&#39;, -1.1078151), (&#39;average_entropy&#39;, 71313.29), (&#39;average_value_loss&#39;, 1.3338033885315612), (&#39;average_policy_loss&#39;, 0.00016046616851613012), (&#39;n_updates&#39;, 54), (&#39;explained_variance&#39;, -155.0251960693383)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:239 episode:15 R:0.04733136688125236
statistics:[(&#39;average_value&#39;, -1.0999826), (&#39;average_entropy&#39;, 71313.29), (&#39;average_value_loss&#39;, 1.3338033885315612), (&#39;average_policy_loss&#39;, 0.00016046616851613012), (&#39;n_updates&#39;, 54), (&#39;explained_variance&#39;, -155.0251960693383)]
outdir:elon_musk_dogecoin step:247 episode:16 R:0.04414926498259348
statistics:[(&#39;average_value&#39;, -1.0872896), (&#39;average_entropy&#39;, 71313.305), (&#39;average_value_loss&#39;, 1.3130737553943288), (&#39;average_policy_loss&#39;, 0.00023882706174679861), (&#39;n_updates&#39;, 55), (&#39;explained_variance&#39;, -133.39454800252926)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:250 episode:17 R:0.026587595267637088
statistics:[(&#39;average_value&#39;, -1.0839288), (&#39;average_entropy&#39;, 71313.31), (&#39;average_value_loss&#39;, 1.3130737553943288), (&#39;average_policy_loss&#39;, 0.00023882706174679861), (&#39;n_updates&#39;, 55), (&#39;explained_variance&#39;, -133.39454800252926)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:255 episode:18 R:0.051060883339943464
statistics:[(&#39;average_value&#39;, -1.075243), (&#39;average_entropy&#39;, 71313.32), (&#39;average_value_loss&#39;, 1.2955336006624358), (&#39;average_policy_loss&#39;, 0.0002585244264342431), (&#39;n_updates&#39;, 56), (&#39;explained_variance&#39;, -19.625075793552828)]
outdir:elon_musk_dogecoin step:260 episode:19 R:0.03691395205937924
statistics:[(&#39;average_value&#39;, -1.0684801), (&#39;average_entropy&#39;, 71313.336), (&#39;average_value_loss&#39;, 1.2955336006624358), (&#39;average_policy_loss&#39;, 0.0002585244264342431), (&#39;n_updates&#39;, 56), (&#39;explained_variance&#39;, -19.625075793552828)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:265 episode:20 R:0.04733136688125236
statistics:[(&#39;average_value&#39;, -1.0598416), (&#39;average_entropy&#39;, 71313.336), (&#39;average_value_loss&#39;, 1.2769644127080315), (&#39;average_policy_loss&#39;, 0.00020445701330461082), (&#39;n_updates&#39;, 57), (&#39;explained_variance&#39;, -11.145038702421743)]
outdir:elon_musk_dogecoin step:270 episode:21 R:0.043883707944988505
statistics:[(&#39;average_value&#39;, -1.050933), (&#39;average_entropy&#39;, 71313.35), (&#39;average_value_loss&#39;, 1.2769644127080315), (&#39;average_policy_loss&#39;, 0.00020445701330461082), (&#39;n_updates&#39;, 57), (&#39;explained_variance&#39;, -11.145038702421743)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:275 episode:22 R:0.051060883339943464
statistics:[(&#39;average_value&#39;, -1.0417138), (&#39;average_entropy&#39;, 71313.35), (&#39;average_value_loss&#39;, 1.2577419260452534), (&#39;average_policy_loss&#39;, 0.0003183023898851263), (&#39;n_updates&#39;, 58), (&#39;explained_variance&#39;, -7.749529898995231)]
outdir:elon_musk_dogecoin step:282 episode:23 R:0.9078032784337866
statistics:[(&#39;average_value&#39;, -1.033803), (&#39;average_entropy&#39;, 71313.37), (&#39;average_value_loss&#39;, 1.2460979980937505), (&#39;average_policy_loss&#39;, 0.00021025619966074651), (&#39;n_updates&#39;, 59), (&#39;explained_variance&#39;, -65.13956917530275)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:294 episode:24 R:0.06501227370126977
statistics:[(&#39;average_value&#39;, -1.0146691), (&#39;average_entropy&#39;, 71313.39), (&#39;average_value_loss&#39;, 1.233799797296524), (&#39;average_policy_loss&#39;, 0.00013127381516824243), (&#39;n_updates&#39;, 60), (&#39;explained_variance&#39;, -5.447836198833656)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:299 episode:25 R:0.03691395205937924
statistics:[(&#39;average_value&#39;, -1.0066292), (&#39;average_entropy&#39;, 71313.4), (&#39;average_value_loss&#39;, 1.233799797296524), (&#39;average_policy_loss&#39;, 0.00013127381516824243), (&#39;n_updates&#39;, 60), (&#39;explained_variance&#39;, -5.447836198833656)]
outdir:elon_musk_dogecoin step:307 episode:26 R:0.030314867869480518
statistics:[(&#39;average_value&#39;, -0.99085534), (&#39;average_entropy&#39;, 71313.414), (&#39;average_value_loss&#39;, 1.2154734047954199), (&#39;average_policy_loss&#39;, 0.0001340141230893558), (&#39;n_updates&#39;, 61), (&#39;explained_variance&#39;, -10.193662811242667)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:313 episode:27 R:0.04454559288270535
statistics:[(&#39;average_value&#39;, -0.97872937), (&#39;average_entropy&#39;, 71313.42), (&#39;average_value_loss&#39;, 1.2004664507844756), (&#39;average_policy_loss&#39;, -3.1615591362952405e-06), (&#39;n_updates&#39;, 62), (&#39;explained_variance&#39;, -33.175360647756264)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:318 episode:28 R:0.903268185582095
statistics:[(&#39;average_value&#39;, -0.97099626), (&#39;average_entropy&#39;, 71313.43), (&#39;average_value_loss&#39;, 1.2004664507844756), (&#39;average_policy_loss&#39;, -3.1615591362952405e-06), (&#39;n_updates&#39;, 62), (&#39;explained_variance&#39;, -33.175360647756264)]
outdir:elon_musk_dogecoin step:324 episode:29 R:0.039902052647162366
statistics:[(&#39;average_value&#39;, -0.95829123), (&#39;average_entropy&#39;, 71313.44), (&#39;average_value_loss&#39;, 1.1893363548886209), (&#39;average_policy_loss&#39;, -0.00011990143655797482), (&#39;n_updates&#39;, 63), (&#39;explained_variance&#39;, -1.5340383131866893)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:327 episode:30 R:0.027468392345032608
statistics:[(&#39;average_value&#39;, -0.9532474), (&#39;average_entropy&#39;, 71313.445), (&#39;average_value_loss&#39;, 1.1893363548886209), (&#39;average_policy_loss&#39;, -0.00011990143655797482), (&#39;n_updates&#39;, 63), (&#39;explained_variance&#39;, -1.5340383131866893)]
outdir:elon_musk_dogecoin step:377 episode:31 R:0
statistics:[(&#39;average_value&#39;, -0.85051185), (&#39;average_entropy&#39;, 71313.5), (&#39;average_value_loss&#39;, 1.242111551520579), (&#39;average_policy_loss&#39;, -0.0001777062998906545), (&#39;n_updates&#39;, 68), (&#39;explained_variance&#39;, -888.0687453298063)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:382 episode:32 R:0.03917782313665549
statistics:[(&#39;average_value&#39;, -0.8399318), (&#39;average_entropy&#39;, 71313.51), (&#39;average_value_loss&#39;, 1.235224168477715), (&#39;average_policy_loss&#39;, -0.0003291908744385169), (&#39;n_updates&#39;, 69), (&#39;explained_variance&#39;, -0.3201928154205531)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:398 episode:33 R:0.042070292485708205
statistics:[(&#39;average_value&#39;, -0.8181706), (&#39;average_entropy&#39;, 71313.52), (&#39;average_value_loss&#39;, 1.2843311149094785), (&#39;average_policy_loss&#39;, -0.0002839365799445659), (&#39;n_updates&#39;, 70), (&#39;explained_variance&#39;, -0.2696518433590207)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:401 episode:34 R:0.026587595267637088
statistics:[(&#39;average_value&#39;, -0.8137186), (&#39;average_entropy&#39;, 71313.516), (&#39;average_value_loss&#39;, 1.2754165699154558), (&#39;average_policy_loss&#39;, -0.00030307473145871306), (&#39;n_updates&#39;, 71), (&#39;explained_variance&#39;, -6376.306062245339)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:435 episode:35 R:0.40446967288710806
statistics:[(&#39;average_value&#39;, -0.77308524), (&#39;average_entropy&#39;, 71313.54), (&#39;average_value_loss&#39;, 1.2388115018807553), (&#39;average_policy_loss&#39;, -0.0004507025736824584), (&#39;n_updates&#39;, 74), (&#39;explained_variance&#39;, -51.03049916475539)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:453 episode:36 R:0.08308987630781423
statistics:[(&#39;average_value&#39;, -0.7523759), (&#39;average_entropy&#39;, 71313.54), (&#39;average_value_loss&#39;, 1.2134499484182972), (&#39;average_policy_loss&#39;, -0.000460378126406699), (&#39;n_updates&#39;, 76), (&#39;explained_variance&#39;, -86.34497778856294)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:458 episode:37 R:0.043883707944988505
statistics:[(&#39;average_value&#39;, -0.74646515), (&#39;average_entropy&#39;, 71313.54), (&#39;average_value_loss&#39;, 1.2134499484182972), (&#39;average_policy_loss&#39;, -0.000460378126406699), (&#39;n_updates&#39;, 76), (&#39;explained_variance&#39;, -86.34497778856294)]
outdir:elon_musk_dogecoin step:463 episode:38 R:0.051060883339943464
statistics:[(&#39;average_value&#39;, -0.74073523), (&#39;average_entropy&#39;, 71313.54), (&#39;average_value_loss&#39;, 1.1993875744474398), (&#39;average_policy_loss&#39;, -0.00037824241489825116), (&#39;n_updates&#39;, 77), (&#39;explained_variance&#39;, -22.64250657127632)]
evaluation episode 0 length:5 R:0.051060883339943464
outdir:elon_musk_dogecoin step:469 episode:39 R:0.03801414681234764
statistics:[(&#39;average_value&#39;, -0.73418707), (&#39;average_entropy&#39;, 71313.54), (&#39;average_value_loss&#39;, 1.1993875744474398), (&#39;average_policy_loss&#39;, -0.00037824241489825116), (&#39;n_updates&#39;, 77), (&#39;explained_variance&#39;, -22.64250657127632)]
outdir:elon_musk_dogecoin step:500 episode:40 R:0
statistics:[(&#39;average_value&#39;, -0.7161389), (&#39;average_entropy&#39;, 71313.53), (&#39;average_value_loss&#39;, 1.1581365015823395), (&#39;average_policy_loss&#39;, -0.0007426668620610144), (&#39;n_updates&#39;, 80), (&#39;explained_variance&#39;, -628.3890231942744)]
evaluation episode 0 length:5 R:0.051060883339943464
Saved the agent to elon_musk_dogecoin/500_finish
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&lt;pfrl.agents.ppo.PPO at 0x7f1438408f10&gt;,
 [{&#39;average_entropy&#39;: 71312.86,
   &#39;average_policy_loss&#39;: -0.0005778993137496537,
   &#39;average_value&#39;: -1.1820644,
   &#39;average_value_loss&#39;: 1.5397733084180139,
   &#39;eval_score&#39;: 0.6118701571341162,
   &#39;explained_variance&#39;: -36.946850889108426,
   &#39;n_updates&#39;: 33},
  {&#39;average_entropy&#39;: 71312.86,
   &#39;average_policy_loss&#39;: -0.0006748329104833401,
   &#39;average_value&#39;: -1.1896302,
   &#39;average_value_loss&#39;: 1.5780798437840797,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -0.7300913744865904,
   &#39;n_updates&#39;: 34},
  {&#39;average_entropy&#39;: 71312.94,
   &#39;average_policy_loss&#39;: -0.0002805701943333798,
   &#39;average_value&#39;: -1.2554632,
   &#39;average_value_loss&#39;: 1.5440955738990734,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -390.4063933607259,
   &#39;n_updates&#39;: 39},
  {&#39;average_entropy&#39;: 71312.98,
   &#39;average_policy_loss&#39;: -0.0002032094211821592,
   &#39;average_value&#39;: -1.2457539,
   &#39;average_value_loss&#39;: 1.5156753742840232,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -51.0615278646253,
   &#39;n_updates&#39;: 41},
  {&#39;average_entropy&#39;: 71312.99,
   &#39;average_policy_loss&#39;: -8.875665203266267e-05,
   &#39;average_value&#39;: -1.2375408,
   &#39;average_value_loss&#39;: 1.5108967859830176,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -1.4907311649594996,
   &#39;n_updates&#39;: 42},
  {&#39;average_entropy&#39;: 71313.06,
   &#39;average_policy_loss&#39;: -8.711994806534759e-05,
   &#39;average_value&#39;: -1.227982,
   &#39;average_value_loss&#39;: 1.493516572158445,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -78.9884378834259,
   &#39;n_updates&#39;: 44},
  {&#39;average_entropy&#39;: 71313.1,
   &#39;average_policy_loss&#39;: 0.00019809898391637642,
   &#39;average_value&#39;: -1.2197058,
   &#39;average_value_loss&#39;: 1.4825191640191608,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -33.81824737099633,
   &#39;n_updates&#39;: 45},
  {&#39;average_entropy&#39;: 71313.22,
   &#39;average_policy_loss&#39;: 0.00033982125845795965,
   &#39;average_value&#39;: -1.1569879,
   &#39;average_value_loss&#39;: 1.3934581258893013,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -431.32679512670745,
   &#39;n_updates&#39;: 50},
  {&#39;average_entropy&#39;: 71313.25,
   &#39;average_policy_loss&#39;: 0.00024142916698530407,
   &#39;average_value&#39;: -1.136288,
   &#39;average_value_loss&#39;: 1.3678271796267767,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -32.041422884933674,
   &#39;n_updates&#39;: 52},
  {&#39;average_entropy&#39;: 71313.266,
   &#39;average_policy_loss&#39;: 0.0001948871455547391,
   &#39;average_value&#39;: -1.1245402,
   &#39;average_value_loss&#39;: 1.3501226932934995,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -370.5535500115619,
   &#39;n_updates&#39;: 53},
  {&#39;average_entropy&#39;: 71313.29,
   &#39;average_policy_loss&#39;: 0.00016046616851613012,
   &#39;average_value&#39;: -1.1078151,
   &#39;average_value_loss&#39;: 1.3338033885315612,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -155.0251960693383,
   &#39;n_updates&#39;: 54},
  {&#39;average_entropy&#39;: 71313.305,
   &#39;average_policy_loss&#39;: 0.00023882706174679861,
   &#39;average_value&#39;: -1.0872896,
   &#39;average_value_loss&#39;: 1.3130737553943288,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -133.39454800252926,
   &#39;n_updates&#39;: 55},
  {&#39;average_entropy&#39;: 71313.31,
   &#39;average_policy_loss&#39;: 0.00023882706174679861,
   &#39;average_value&#39;: -1.0839288,
   &#39;average_value_loss&#39;: 1.3130737553943288,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -133.39454800252926,
   &#39;n_updates&#39;: 55},
  {&#39;average_entropy&#39;: 71313.336,
   &#39;average_policy_loss&#39;: 0.0002585244264342431,
   &#39;average_value&#39;: -1.0684801,
   &#39;average_value_loss&#39;: 1.2955336006624358,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -19.625075793552828,
   &#39;n_updates&#39;: 56},
  {&#39;average_entropy&#39;: 71313.35,
   &#39;average_policy_loss&#39;: 0.00020445701330461082,
   &#39;average_value&#39;: -1.050933,
   &#39;average_value_loss&#39;: 1.2769644127080315,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -11.145038702421743,
   &#39;n_updates&#39;: 57},
  {&#39;average_entropy&#39;: 71313.37,
   &#39;average_policy_loss&#39;: 0.00021025619966074651,
   &#39;average_value&#39;: -1.033803,
   &#39;average_value_loss&#39;: 1.2460979980937505,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -65.13956917530275,
   &#39;n_updates&#39;: 59},
  {&#39;average_entropy&#39;: 71313.39,
   &#39;average_policy_loss&#39;: 0.00013127381516824243,
   &#39;average_value&#39;: -1.0146691,
   &#39;average_value_loss&#39;: 1.233799797296524,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -5.447836198833656,
   &#39;n_updates&#39;: 60},
  {&#39;average_entropy&#39;: 71313.414,
   &#39;average_policy_loss&#39;: 0.0001340141230893558,
   &#39;average_value&#39;: -0.99085534,
   &#39;average_value_loss&#39;: 1.2154734047954199,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -10.193662811242667,
   &#39;n_updates&#39;: 61},
  {&#39;average_entropy&#39;: 71313.42,
   &#39;average_policy_loss&#39;: -3.1615591362952405e-06,
   &#39;average_value&#39;: -0.97872937,
   &#39;average_value_loss&#39;: 1.2004664507844756,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -33.175360647756264,
   &#39;n_updates&#39;: 62},
  {&#39;average_entropy&#39;: 71313.44,
   &#39;average_policy_loss&#39;: -0.00011990143655797482,
   &#39;average_value&#39;: -0.95829123,
   &#39;average_value_loss&#39;: 1.1893363548886209,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -1.5340383131866893,
   &#39;n_updates&#39;: 63},
  {&#39;average_entropy&#39;: 71313.5,
   &#39;average_policy_loss&#39;: -0.0001777062998906545,
   &#39;average_value&#39;: -0.85051185,
   &#39;average_value_loss&#39;: 1.242111551520579,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -888.0687453298063,
   &#39;n_updates&#39;: 68},
  {&#39;average_entropy&#39;: 71313.51,
   &#39;average_policy_loss&#39;: -0.0003291908744385169,
   &#39;average_value&#39;: -0.8399318,
   &#39;average_value_loss&#39;: 1.235224168477715,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -0.3201928154205531,
   &#39;n_updates&#39;: 69},
  {&#39;average_entropy&#39;: 71313.52,
   &#39;average_policy_loss&#39;: -0.0002839365799445659,
   &#39;average_value&#39;: -0.8181706,
   &#39;average_value_loss&#39;: 1.2843311149094785,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -0.2696518433590207,
   &#39;n_updates&#39;: 70},
  {&#39;average_entropy&#39;: 71313.516,
   &#39;average_policy_loss&#39;: -0.00030307473145871306,
   &#39;average_value&#39;: -0.8137186,
   &#39;average_value_loss&#39;: 1.2754165699154558,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -6376.306062245339,
   &#39;n_updates&#39;: 71},
  {&#39;average_entropy&#39;: 71313.54,
   &#39;average_policy_loss&#39;: -0.0004507025736824584,
   &#39;average_value&#39;: -0.77308524,
   &#39;average_value_loss&#39;: 1.2388115018807553,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -51.03049916475539,
   &#39;n_updates&#39;: 74},
  {&#39;average_entropy&#39;: 71313.54,
   &#39;average_policy_loss&#39;: -0.000460378126406699,
   &#39;average_value&#39;: -0.7523759,
   &#39;average_value_loss&#39;: 1.2134499484182972,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -86.34497778856294,
   &#39;n_updates&#39;: 76},
  {&#39;average_entropy&#39;: 71313.54,
   &#39;average_policy_loss&#39;: -0.00037824241489825116,
   &#39;average_value&#39;: -0.74073523,
   &#39;average_value_loss&#39;: 1.1993875744474398,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -22.64250657127632,
   &#39;n_updates&#39;: 77},
  {&#39;average_entropy&#39;: 71313.53,
   &#39;average_policy_loss&#39;: -0.0007426668620610144,
   &#39;average_value&#39;: -0.7161389,
   &#39;average_value_loss&#39;: 1.1581365015823395,
   &#39;eval_score&#39;: 0.051060883339943464,
   &#39;explained_variance&#39;: -628.3890231942744,
   &#39;n_updates&#39;: 80}])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>loading the best result and predict.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;./elon_musk_dogecoin/best&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">actor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="s1">&#39;i think dogecoin is&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39; a great idea, but I think it is a little overused.&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/2021/07/25/textrl-elon-musk.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Voidful.Dev</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/voidful" title="voidful"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/voidful_stack" title="voidful_stack"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
